<view class="container">
    <view class="header">
      <text class="date">{{date}}</text>
    </view>

    <!-- ç”Ÿæˆä¸­çŠ¶æ€ -->
    <view wx:if="{{generating}}" class="generating-banner">
      <view class="generating-top">
        <view class="spinner"></view>
        <text class="generating-step">{{generatingStep}}</text>
        <text wx:if="{{progressPercent}}" class="generating-percent">{{progressPercent}}%</text>
      </view>
      <text wx:if="{{progressDetail}}" class="generating-detail">{{progressDetail}}</text>
      <view wx:if="{{progressPercent}}" class="progress-bar">
        <view class="progress-fill" style="width: {{progressPercent}}%"></view>
      </view>
    </view>

    <!-- é…ç½®æç¤º -->
    <view class="config-tip" bindtap="goToProfile">
      <text><text class="tip-link">è®¾ç½®ç ”ç©¶å…´è¶£</text>ï¼Œè·å–ä¸ªæ€§åŒ–æ¨è</text>
      <text class="tip-arrow">â€º</text>
    </view>

    <view wx:if="{{loading}}" class="skeleton-list">
    <view class="skeleton-card" wx:for="{{[1,2,3]}}" wx:key="*this">
      <view class="skeleton-header">
        <view class="skeleton-source"></view>
        <view class="skeleton-score"></view>
      </view>
      <view class="skeleton-title"></view>
      <view class="skeleton-summary"></view>
      <view class="skeleton-summary short"></view>
    </view>
  </view>

    <!-- é”™è¯¯çŠ¶æ€ -->
    <view wx:elif="{{error}}" class="error-state">
      <view class="error-icon">âš ï¸</view>
      <text class="error-title">{{errorMsg}}</text>
      <button class="retry-btn" bindtap="onTapRetry">é‡è¯•</button>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{!generating && articles.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“„</view>
      <text class="empty-title">è¿˜æ²¡æœ‰ä»Šæ—¥æ—¥æŠ¥</text>
      <text class="empty-desc">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ç”Ÿæˆä½ çš„ä¸ªæ€§åŒ–æ—¥æŠ¥</text>
      <button class="generate-btn" bindtap="triggerGenerate">ç«‹å³ç”Ÿæˆ</button>
    </view>

    <!-- æ–‡ç« åˆ—è¡¨ -->
    <view wx:else class="list">
      <view
        wx:for="{{articles}}"
        wx:key="id"
        class="card {{item.is_vip ? 'vip' : ''}}"
        bindtap="onTapArticle"
        data-id="{{item.id}}"
      >
        <view class="card-header">
          <text class="source">{{item.journal}}</text>
          <text class="score">{{item.scoreDisplay}}%</text>
        </view>
        <view class="card-title">{{item.title}}</view>
        <view class="card-summary">{{item.summary}}</view>
        <view wx:if="{{item.is_vip}}" class="vip-tag">
          {{item.vip_keywords[0]}}
        </view>
      </view>

      <!-- é‡æ–°ç”ŸæˆæŒ‰é’® -->
      <view wx:if="{{isPersonalized && !queryDate}}" class="regenerate-section">
        <button class="regenerate-btn" bindtap="onTapRegenerate">é‡æ–°ç”Ÿæˆä¸ªæ€§åŒ–æ—¥æŠ¥</button>
      </view>
    </view>
  </view>